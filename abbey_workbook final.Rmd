---
title: "R Notebook"
output: html_notebook
---

```{r}
#install.packages('sf')
#install.packages('leaflet')

library(tidyverse)
library(janitor)
library(sf)
library(leaflet)

```

```{r}

#the first graph I wanted to identify was how many violent crimes resulted in arrests in Baltimore and what percent of violent crimes actually resulted in arrests. 

homicide_data <- rio::import("https://raw.githubusercontent.com/abbweltman/data-homicides/master/homicide-data.csv") %>% 
 as.data.frame() %>% 
  clean_names()

balt_homicides <- homicide_data %>%
  filter(city == "Baltimore") %>% 
  mutate(date1 = lubridate::ymd(reported_date)) %>% 
  mutate(year = year(date1))

#In this table we can see that there were 2827 homicides in Baltimore now I want to see how many of these crimes resulted in an arrests. 

balt_homicides_yr_arrests <- balt_homicides %>% 
count(disposition, year) %>% 
group_by(disposition, year) %>% 
filter(disposition == "Closed by arrest") %>% 
mutate(arrests = n) 

balt_homicides_yr <- balt_homicides %>% 
  count(year) %>% 
  group_by(year) %>% 
mutate(total = n) 

balt_total_arrests <- balt_homicides_yr %>% 
inner_join(balt_homicides_yr_arrests, by="year")%>%
mutate(pct_whole = arrests / total * 100)%>%
select(year, disposition, total, arrests, pct_whole)

sum(balt_total_arrests$arrests) / sum(balt_total_arrests$total)

#With this table I was able to conclude that 1002 of these crimes were closed by arrest. Then If I divide 1002 by 2827 I get a percent of 35.44% of these homicides resulting in a arrest. In the story they say fewer then 27%. So now I will take this table and apply it to the years highlighted in the story
```


```{r}
balt_arrests_14 <- balt_homicides %>%
  group_by(disposition) %>% 
filter(year == "2014")%>%
count(disposition)
sum(balt_arrests_14$n)

balt_arrests_14_arrests <- balt_arrests_14 %>% 
  filter(disposition == "Closed by arrest")
sum(balt_arrests_14_arrests$n) / sum(balt_arrests_14$n)

#For 2014 the sum of all the violent crimes was 211 if you divide 211 by the amount of crimes closed by arrests 86 you get an arrest rate of 40.7% this represents the 41% of arrests mentioned in the story. 

balt_arrests_17 <- balt_homicides %>%
  group_by(disposition) %>% 
filter(year == "2017")%>%
  count(disposition)
sum(balt_arrests_17$n)

balt_arrests_17_arrests <- balt_arrests_17 %>% 
  filter(disposition == "Closed by arrest") 
sum(balt_arrests_17_arrests$n) / sum(balt_arrests_17$n)

# For 2017 I divided the 93 cases closed by arrests by the 340 total crimes to get an arrest rate in 2017 of which is where the story got the 27%. Therefore since 2014 rate of arrests in Baltimore has dropped 14 percentage points which is what was stated in the story as well. 
  
```

```{r}
#Next I want to look at the change in crime rate in Baltimore from 2014-2018 becasue the article referenced a spike in crime after 2015 and by looking at the crime rate of each year in Baltimore from before that year until when the article was posted we can see if this trend exists in the data. I created my own data table from FBI database, voilent crime known by law enforcement. 

bmore_cr <- rio::import("https://github.com/abbweltman/data-homicides/raw/master/Baltimore%20Crime%20Rate%20Data-2.xlsx")  %>%
  as.data.frame() %>% 
  clean_names()

bmore_cr <- bmore_cr %>%
 select(city,population, violent_crime) %>%
  mutate(crime_rate= (violent_crime/population * 1000 )) 

#With this table I can see the crime rates per 1000 people of each year and determine how many percentage points it changed each year from this code I can determine that there was gradual increase in Violent crime per 100 people after 2015. From this chart is says the highest crime rate was in 2017. 
     
```

```{r}
#The story also reported that since 2015 the arrest rate has never rose about 30% so now we will look at the 2015 through 2018 when the story was published to see if the percent of arrests ever rose above 30% 

balt_arrests_15 <- balt_homicides %>%
  group_by(disposition) %>% 
filter(year == "2015")%>%
count(disposition)
sum(balt_arrests_15$n)

balt_arrests_15_arrests <- balt_arrests_15 %>% 
  filter(disposition == "Closed by arrest")
sum(balt_arrests_15_arrests$n) / sum(balt_arrests_15$n)

# 342 is the sum of violent crime cases if you divide this by 87 closed cases I get a arrest rate of 25% this the arrest rate dropped 15 percentage points from 2014 indicated before in the 2014 arrest table and also in the story. 25% is lower than the 30% the story said was not passed since then. 

balt_arrests_16 <- balt_homicides %>%
  group_by(disposition) %>% 
filter(year == "2016")%>%
count(disposition)
sum(balt_arrests_16$n)

balt_arrests_16_arrests <- balt_arrests_16 %>% 
  filter(disposition == "Closed by arrest")
sum(balt_arrests_16_arrests$n) / sum(balt_arrests_16$n)

#in 2016 the arrest rate was 72/320 = 22.5% this corresponds with the story. We also know the next value in 2017 is 27% which also makes the story correct. This was the last year aviailable in the data.  

```

```{r}
#I want to examine the rate of arrest so I went to Baltimore Indicators Alliance and pulled the Number of arrests per 1000 residents in Baltimore. 

library(ggplot2)
balt_total_arrests  %>% 
   ggplot(aes(x=year, y=pct_whole, weight=pct_whole, fill=pct_whole))+
  geom_col()

```
```{r}
#MEMO

#The purpose of my notebook was to validate the findings in the story and expose the disparity between homicides and arrests in Baltimore. In the Washington Post, they did a deep dive into Baltimore homicides and how often these violent crimes result in arrests. In this analysis, they were able to identify spikes in crime rate and the gradual decline of the success of law enforcement in bringing justice to the families mourning victims of these crimes. 

#The reporters were able to use the data with compelling stories to strengthen the impact. For example, when they spoke about one of the founding members of the Mothers of Murdered Sons and Daughters United Daphne Alston, and the loss of her son, that is only one instance. It is hard to put into perspective how often these crimes are occurring. By supporting the tragic stories with the hard-hitting data readers are quick to realize the severity of the problem. This strategy was effective in showing the audience that the victims are rising and justice is declining in these crimes. 

#The reporters communicated this in the story by creating a timeline in chronological order. They talked about current events that could be tied to the changes in the data and when they occur. They showed the chain of events that led to more and more violence. It started with Freddie Gray's death in 2015. They use that event to talk about the surge of crimes after 2015 and then the data shown each year after that. They talk about events from 2015 and then transition into declining results from law enforcement leading to mistrust from Baltimore civilians. 

#I followed this structure with my notebook as well. I first created a table that showed the Baltimore Homicides that were closed by arrests each year. Then I was able to join that with the total population to find the percentage of arrests per year and then the overall percentage from the past 5 years. After that, I also created my notebook in chronological order by creating a table for each year. For the next chunk, I curated my own data set using the FBI Census data about violent crimes for each year. I was able to access the violent crimes each year to calculate the total crime rate in Baltimore for each year. 

#For data set transparency the reporter did a good job of explaining where all the data came from. Many of the reports were from the police and law enforcement data. However, they only mention the homicide data briefly once. I think this story would benefit a lot from hyperlinks to specific infographics or visuals that displayed the findings of the data. I found a major flaw of the original story was that it had a section about the geographical pattern of data in the â€œblack butterfly: but the Washington Post did not have it displayed in the story. It is easy to find where the data is from but they could have made it more impactful by including graphics, charts, or maps displaying the rise in crime. However, the storytelling was done very well in terms of pulling on heartstrings and capturing the audience. 

#In my notebook I was able to show percents that were easy to conceptualize and match with the story. The story Identified this problem and its large effect on the community.

